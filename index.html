<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulta PPA - Prefeitura de Barcarena</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/3.3.0/tailwind.min.js"></script>
    <style>
        /* Custom animations */
        .fade-in {
            opacity: 1;
            transform: scale(1) translateX(0);
        }
        .fade-out {
            opacity: 0;
            transform: scale(0.95);
        }
        .slide-right-out {
            transform: translateX(-100%);
        }
        .slide-left-out {
            transform: translateX(100%);
        }
        .transition-all-300 {
            transition: all 0.3s ease-in-out;
        }
        .screen-reader-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        .screen-reader-only:focus {
            position: absolute;
            padding: 8px;
            margin: 0;
            overflow: visible;
            clip: auto;
            white-space: normal;
            background: #059669;
            color: white;
            z-index: 50;
            top: 16px;
            left: 16px;
            border-radius: 6px;
        }
        
        /* FAQ accordion animations */
        .accordion-content {
            transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        
        /* Dark theme variables */
        :root {
            --bg-light: #f0fdf4;
            --bg-dark: #111827;
            --text-light: #1f2937;
            --text-dark: #f9fafb;
        }
        
        .dark-theme {
            background: var(--bg-dark);
            color: var(--text-dark);
        }
        
        .light-theme {
            background: var(--bg-light);
            color: var(--text-light);
        }
    </style>
</head>
<body class="light-theme">
    <div id="app" class="min-h-screen bg-gradient-to-b from-green-50 to-green-100 py-4 px-2 sm:py-8 sm:px-4 transition-colors duration-300">
        <div class="max-w-4xl mx-auto relative">
            <!-- Header -->
            <header class="mb-4 sm:mb-6 text-center">
                <div class="flex justify-center mb-2 sm:mb-4">
                    <div class="flex items-center p-2 sm:p-3 bg-white rounded-lg shadow-sm transition-colors duration-300" id="logo-container">
                        <div class="w-12 h-12 sm:w-14 sm:h-14 bg-green-600 rounded-full flex items-center justify-center mr-2 sm:mr-3 text-white font-bold text-xl sm:text-2xl">
                            B
                        </div>
                        <div class="text-left">
                            <div class="text-xs sm:text-sm font-semibold text-gray-600" id="prefeitura-text">PREFEITURA DE</div>
                            <div class="text-xl sm:text-2xl font-bold text-gray-800" id="barcarena-text">BARCARENA</div>
                        </div>
                    </div>
                </div>
                <h2 class="text-lg sm:text-xl font-bold text-green-800" id="main-title">
                    Plano Plurianual Participativo 2026-2029
                </h2>
            </header>
            
            <!-- Main Content Container -->
            <div id="main-content"></div>
            
            <!-- Footer -->
            <footer class="mt-6 sm:mt-8 text-center text-gray-500 text-xs sm:text-sm" id="footer-content">
                <p>© 2025 Prefeitura Municipal de Barcarena</p>
                <p>Secretaria de Planejamento e Articulação Institucional</p>
                <p>Plano Plurianual Participativo 2026-2029</p>
            </footer>
            
            <!-- Theme Toggle Button -->
            <button id="theme-toggle" class="fixed bottom-4 right-4 p-2 rounded-full bg-white text-gray-800 shadow-lg" aria-label="Ativar tema escuro">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" id="theme-icon">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
        </div>
        
        <!-- Status messages for screen readers -->
        <div role="status" aria-live="polite" class="screen-reader-only" id="status-message"></div>
    </div>

    <script>
        // Global state management
        const AppState = {
            // Theme
            isDarkTheme: false,
            
            // Current screen
            currentScreen: 'inicial',
            fadeIn: true,
            slideDirection: 'direita',
            statusMessage: '',
            
            // FAQ state
            openFAQItems: new Set(),
            
            // Form data
            problema: '',
            regiao: '',
            bairro: '',
            genero: '',
            ocupacao: '',
            cep: '',
            whatsapp: '',
            error: '',
            isSubmitting: false,
            
            // iOS detection
            isIOS: false,
            
            // Refs for uncontrolled inputs on iOS
            problemaRef: null,
            bairroRef: null,
            cepRef: null,
            whatsappRef: null,
            focusRef: null
        };

        // iOS Detection
        function detectIOS() {
            const userAgent = navigator.userAgent || navigator.vendor || window.opera;
            const isIOSDevice = /iPad|iPhone|iPod/.test(userAgent) && !window.MSStream;
            AppState.isIOS = isIOSDevice;
            
            if (isIOSDevice) {
                console.log("Dispositivo iOS detectado");
            }
            
            return isIOSDevice;
        }

        // Formatters
        function formatCEP(value) {
            if (!value) return '';
            
            const numericValue = value.replace(/\D/g, '');
            const truncatedValue = numericValue.slice(0, 8);
            
            if (truncatedValue.length > 5) {
                return `${truncatedValue.slice(0, 5)}-${truncatedValue.slice(5)}`;
            }
            
            return truncatedValue;
        }

        function formatPhone(value) {
            if (!value) return '';
            
            const numericValue = value.replace(/\D/g, '');
            const truncatedValue = numericValue.slice(0, 11);
            
            if (truncatedValue.length <= 2) {
                return `(${truncatedValue}`;
            } else if (truncatedValue.length <= 6) {
                return `(${truncatedValue.slice(0, 2)}) ${truncatedValue.slice(2)}`;
            } else if (truncatedValue.length <= 10) {
                return `(${truncatedValue.slice(0, 2)}) ${truncatedValue.slice(2, 6)}-${truncatedValue.slice(6)}`;
            } else {
                return `(${truncatedValue.slice(0, 2)}) ${truncatedValue.slice(2, 7)}-${truncatedValue.slice(7)}`;
            }
        }

        // Theme management
        function toggleTheme() {
            AppState.isDarkTheme = !AppState.isDarkTheme;
            updateTheme();
        }

        function updateTheme() {
            const body = document.body;
            const app = document.getElementById('app');
            const logoContainer = document.getElementById('logo-container');
            const prefeituraText = document.getElementById('prefeitura-text');
            const barcarenaText = document.getElementById('barcarena-text');
            const mainTitle = document.getElementById('main-title');
            const footerContent = document.getElementById('footer-content');
            const themeToggle = document.getElementById('theme-toggle');
            const themeIcon = document.getElementById('theme-icon');
            
            if (AppState.isDarkTheme) {
                body.className = 'dark-theme';
                app.className = 'min-h-screen bg-gray-900 py-4 px-2 sm:py-8 sm:px-4 transition-colors duration-300';
                logoContainer.className = 'flex items-center p-2 sm:p-3 bg-gray-800 rounded-lg shadow-sm transition-colors duration-300';
                prefeituraText.className = 'text-xs sm:text-sm font-semibold text-gray-400';
                barcarenaText.className = 'text-xl sm:text-2xl font-bold text-gray-100';
                mainTitle.className = 'text-lg sm:text-xl font-bold text-gray-100';
                footerContent.className = 'mt-6 sm:mt-8 text-center text-gray-400 text-xs sm:text-sm';
                themeToggle.className = 'fixed bottom-4 right-4 p-2 rounded-full bg-gray-700 text-yellow-300 shadow-lg';
                themeToggle.setAttribute('aria-label', 'Ativar tema claro');
                
                themeIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                `;
            } else {
                body.className = 'light-theme';
                app.className = 'min-h-screen bg-gradient-to-b from-green-50 to-green-100 py-4 px-2 sm:py-8 sm:px-4 transition-colors duration-300';
                logoContainer.className = 'flex items-center p-2 sm:p-3 bg-white rounded-lg shadow-sm transition-colors duration-300';
                prefeituraText.className = 'text-xs sm:text-sm font-semibold text-gray-600';
                barcarenaText.className = 'text-xl sm:text-2xl font-bold text-gray-800';
                mainTitle.className = 'text-lg sm:text-xl font-bold text-green-800';
                footerContent.className = 'mt-6 sm:mt-8 text-center text-gray-500 text-xs sm:text-sm';
                themeToggle.className = 'fixed bottom-4 right-4 p-2 rounded-full bg-white text-gray-800 shadow-lg';
                themeToggle.setAttribute('aria-label', 'Ativar tema escuro');
                
                themeIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                `;
            }
            
            // Re-render current screen to apply theme
            renderCurrentScreen();
        }

        // FAQ functions
        function toggleFAQItem(itemId) {
            if (AppState.openFAQItems.has(itemId)) {
                AppState.openFAQItems.delete(itemId);
            } else {
                AppState.openFAQItems.add(itemId);
            }
            renderCurrentScreen();
        }

        function openFAQ() {
            changeScreen('faq', 'direita');
        }

        // Screen management
        function changeScreen(newScreen, direction = 'direita') {
            syncFormValues();
            
            AppState.slideDirection = direction;
            AppState.fadeIn = false;
            
            const mainContent = document.getElementById('main-content');
            mainContent.style.opacity = '0';
            if (direction === 'direita') {
                mainContent.style.transform = 'translateX(-100%)';
            } else {
                mainContent.style.transform = 'translateX(100%)';
            }
            
            setTimeout(() => {
                AppState.currentScreen = newScreen;
                setTimeout(() => {
                    AppState.fadeIn = true;
                    setStatusMessage(`Tela de ${getScreenName(newScreen)} carregada`);
                    setTimeout(() => setStatusMessage(''), 1000);
                    renderCurrentScreen();
                    
                    // Focus management
                    setTimeout(() => {
                        const focusElement = AppState.focusRef;
                        if (focusElement) {
                            try {
                                focusElement.focus();
                            } catch (e) {
                                console.log("Erro ao definir foco:", e);
                            }
                        }
                    }, 600);
                }, 50);
            }, 300);
        }

        function getScreenName(screenName) {
            switch(screenName) {
                case 'inicial': return 'informações iniciais';
                case 'faq': return 'perguntas frequentes';
                case 'formulario': return 'indicação de problema';
                case 'pessoal': return 'dados pessoais';
                case 'confirmacao': return 'confirmação de envio';
                case 'whatsapp-confirmacao': return 'confirmação do WhatsApp';
                default: return screenName;
            }
        }

        function setStatusMessage(message) {
            AppState.statusMessage = message;
            const statusElement = document.getElementById('status-message');
            if (statusElement) {
                statusElement.textContent = message;
            }
        }

        // Form validation and submission
        function validateAndAdvance() {
            syncFormValues();
            AppState.error = '';
            
            const problemaValue = AppState.isIOS && AppState.problemaRef ? 
                                 AppState.problemaRef.value : AppState.problema;
            const bairroValue = AppState.isIOS && AppState.bairroRef ? 
                               AppState.bairroRef.value : AppState.bairro;
            
            console.log("Validando formulário:", { 
                problema: problemaValue, 
                regiao: AppState.regiao, 
                bairro: bairroValue,
                isIOS: AppState.isIOS
            });
            
            if (!problemaValue || problemaValue.trim() === '') {
                AppState.error = 'Por favor, descreva o problema.';
                renderCurrentScreen();
                if (AppState.isIOS && AppState.problemaRef) {
                    setTimeout(() => AppState.problemaRef.focus(), 100);
                }
                return;
            }
            
            if (!AppState.regiao || AppState.regiao === '') {
                AppState.error = 'Por favor, selecione uma região.';
                renderCurrentScreen();
                return;
            }

            if (!bairroValue || bairroValue.trim() === '') {
                AppState.error = 'Por favor, indique o bairro ou localidade.';
                renderCurrentScreen();
                if (AppState.isIOS && AppState.bairroRef) {
                    setTimeout(() => AppState.bairroRef.focus(), 100);
                }
                return;
            }
            
            changeScreen('pessoal', 'direita');
        }

        function validateAndSubmit() {
            syncFormValues();
            AppState.error = '';
            
            if (!AppState.genero || AppState.genero === '') {
                AppState.error = 'Por favor, selecione seu gênero.';
                renderCurrentScreen();
                return;
            }
            
            if (!AppState.ocupacao || AppState.ocupacao === '') {
                AppState.error = 'Por favor, selecione sua ocupação.';
                renderCurrentScreen();
                return;
            }

            const cepValue = AppState.isIOS && AppState.cepRef ? 
                            formatCEP(AppState.cepRef.value) : AppState.cep;
            const cepNumbers = cepValue.replace(/\D/g, '');
            
            if (cepNumbers.length !== 8) {
                AppState.error = 'Por favor, informe um CEP válido com 8 dígitos.';
                renderCurrentScreen();
                if (AppState.isIOS && AppState.cepRef) {
                    setTimeout(() => AppState.cepRef.focus(), 100);
                }
                return;
            }
            
            AppState.isSubmitting = true;
            setStatusMessage('Enviando sua contribuição...');
            renderCurrentScreen();
            
            setTimeout(() => {
                AppState.isSubmitting = false;
                setStatusMessage('Contribuição enviada com sucesso!');
                changeScreen('confirmacao', 'direita');
            }, 1500);
        }

        function validateAndSubmitWhatsApp() {
            syncFormValues();
            AppState.error = '';
            
            const whatsappValue = AppState.isIOS && AppState.whatsappRef ? 
                                 formatPhone(AppState.whatsappRef.value) : AppState.whatsapp;
            const phoneNumbers = whatsappValue.replace(/\D/g, '');
            
            if (phoneNumbers.length < 10 || phoneNumbers.length > 11) {
                AppState.error = 'Por favor, informe um número de WhatsApp válido com DDD (10 ou 11 dígitos).';
                renderCurrentScreen();
                if (AppState.isIOS && AppState.whatsappRef) {
                    setTimeout(() => AppState.whatsappRef.focus(), 100);
                }
                return;
            }
            
            AppState.isSubmitting = true;
            setStatusMessage('Registrando seu contato...');
            renderCurrentScreen();
            
            setTimeout(() => {
                AppState.isSubmitting = false;
                setStatusMessage('Contato registrado com sucesso!');
                changeScreen('whatsapp-confirmacao', 'direita');
            }, 1500);
        }

        function goBack() {
            syncFormValues();
            
            let newScreen = 'inicial';
            
            if (AppState.currentScreen === 'faq') {
                newScreen = 'inicial';
            } else if (AppState.currentScreen === 'formulario') {
                newScreen = 'inicial';
            } else if (AppState.currentScreen === 'pessoal') {
                newScreen = 'formulario';
            } else if (AppState.currentScreen === 'confirmacao' || AppState.currentScreen === 'whatsapp-confirmacao') {
                newScreen = 'inicial';
                clearForm();
            }
            
            changeScreen(newScreen, 'esquerda');
            AppState.error = '';
        }

        function clearForm() {
            AppState.problema = '';
            AppState.regiao = '';
            AppState.bairro = '';
            AppState.genero = '';
            AppState.ocupacao = '';
            AppState.cep = '';
            AppState.whatsapp = '';
            AppState.error = '';
            AppState.openFAQItems.clear();
            
            if (AppState.isIOS) {
                if (AppState.problemaRef) AppState.problemaRef.value = '';
                if (AppState.bairroRef) AppState.bairroRef.value = '';
                if (AppState.cepRef) AppState.cepRef.value = '';
                if (AppState.whatsappRef) AppState.whatsappRef.value = '';
            }
        }

        // iOS form sync
        function syncFormValues() {
            if (AppState.isIOS) {
                if (AppState.currentScreen === 'formulario') {
                    if (AppState.problemaRef) {
                        const value = AppState.problemaRef.value;
                        AppState.problema = value;
                        console.log("Sincronizando problema:", value);
                    }
                    if (AppState.bairroRef) {
                        const value = AppState.bairroRef.value;
                        AppState.bairro = value;
                        console.log("Sincronizando bairro:", value);
                    }
                } 
                else if (AppState.currentScreen === 'pessoal') {
                    if (AppState.cepRef) {
                        const value = formatCEP(AppState.cepRef.value);
                        AppState.cep = value;
                        console.log("Sincronizando CEP:", value);
                    }
                }
                else if (AppState.currentScreen === 'confirmacao') {
                    if (AppState.whatsappRef) {
                        const value = formatPhone(AppState.whatsappRef.value);
                        AppState.whatsapp = value;
                        console.log("Sincronizando WhatsApp:", value);
                    }
                }
            }
        }

        function setupIOSListeners() {
            if (AppState.isIOS) {
                const addInputListener = (ref, stateSetter, formatter = null) => {
                    if (ref) {
                        const handleInput = (e) => {
                            const value = formatter ? formatter(e.target.value) : e.target.value;
                            stateSetter(value);
                            console.log("Input atualizado:", value);
                        };
                        
                        ref.addEventListener('input', handleInput);
                        ref.addEventListener('change', handleInput);
                        ref.addEventListener('blur', handleInput);
                    }
                };
                
                if (AppState.problemaRef) {
                    addInputListener(AppState.problemaRef, (val) => AppState.problema = val);
                }
                if (AppState.bairroRef) {
                    addInputListener(AppState.bairroRef, (val) => AppState.bairro = val);
                }
                if (AppState.cepRef) {
                    addInputListener(AppState.cepRef, (val) => AppState.cep = val, formatCEP);
                }
                if (AppState.whatsappRef) {
                    addInputListener(AppState.whatsappRef, (val) => AppState.whatsapp = val, formatPhone);
                }
            }
        }

        // Error display component
        function renderErrorMessage(error) {
            if (!error) return '';
            
            const bgClass = AppState.isDarkTheme ? 'bg-red-900/20 border-red-700' : 'bg-red-50 border-red-500';
            const textClass = AppState.isDarkTheme ? 'text-red-400' : 'text-red-600';
            
            return `
                <div class="mt-4 ${bgClass} border-l-4 p-3 rounded-r-md text-sm" role="alert" aria-live="assertive">
                    <div class="flex">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 ${textClass}" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                        </svg>
                        <p>${error}</p>
                    </div>
                </div>
            `;
        }

        // Screen renderers
        function renderTelaInicial() {
            const containerClass = AppState.isDarkTheme ? 'bg-gray-800 text-gray-100' : 'bg-white text-gray-800';
            const headerClass = AppState.isDarkTheme ? 'bg-green-700' : 'bg-green-600';
            const highlightClass = AppState.isDarkTheme ? 'text-green-400' : 'text-green-500';
            const cardClass = AppState.isDarkTheme ? 'bg-gray-700/50' : 'bg-gray-50';
            const alertClass = AppState.isDarkTheme ? 'bg-amber-900/20 border-amber-700' : 'bg-yellow-50 border-yellow-400';
            const borderClass = AppState.isDarkTheme ? 'border-green-800' : 'border-green-100';
            const redClass = AppState.isDarkTheme ? 'text-red-400' : 'text-red-600';
            const greenDotClass = AppState.isDarkTheme ? 'bg-green-500' : 'bg-green-600';
            const redDotClass = AppState.isDarkTheme ? 'bg-red-500' : 'bg-red-600';
            
            return `
                <div class="${containerClass} p-4 sm:p-6 rounded-xl shadow-lg max-w-2xl mx-auto transition-all duration-300 transform ${AppState.fadeIn ? 'opacity-100 scale-100' : 'opacity-0 scale-95'}" role="region" aria-labelledby="titulo-principal">
                    <a href="#conteudo-principal" class="screen-reader-only">Pular para o conteúdo principal</a>
                    
                    <div class="${headerClass} text-white p-3 sm:p-4 rounded-t-xl -mt-4 -mx-4 sm:-mt-6 sm:-mx-6 mb-6 relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-r from-green-600 to-green-500 opacity-50"></div>
                        <div class="relative z-10">
                            <h1 id="titulo-principal" class="text-xl sm:text-2xl font-bold text-center">
                                Nos ajude a construir a cidade que a gente quer
                            </h1>
                        </div>
                    </div>

                    <main id="conteudo-principal" tabindex="-1">
                        <h2 class="text-lg sm:text-xl font-semibold ${highlightClass} mb-4 flex items-center">
                            <span class="inline-block w-2 h-6 bg-green-500 mr-2 rounded" aria-hidden="true"></span>
                            A hora é agora, não deixe de participar!
                        </h2>
                        
                        <div class="${alertClass} border-l-4 p-3 sm:p-4 mb-6 rounded-r-md">
                            <p class="font-medium">Não dá pra pensar em soluções sem antes conhecer bem cada problema.</p>
                        </div>
                        
                        <section class="mb-6 space-y-4" aria-labelledby="secao-problema-publico">
                            <h3 id="secao-problema-publico" class="text-base sm:text-lg font-semibold ${highlightClass} border-b ${borderClass} pb-2 mb-4 flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                                O Que é um Problema Público?
                            </h3>
                            
                            <div class="p-4 rounded-lg ${cardClass}">
                                <p class="mb-4 text-sm sm:text-base">Um problema público representa uma <strong>situação indesejável que afeta coletivamente a população</strong> e requer ação governamental para ser resolvido.</p>
                                
                                <div class="mb-4">
                                    <p class="font-medium ${highlightClass} mb-2 text-sm sm:text-base flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                                        </svg>
                                        Exemplos de problemas bem formulados:
                                    </p>
                                    <ul class="list-none pl-5 space-y-2 text-sm sm:text-base">
                                        <li class="flex items-start">
                                            <span class="inline-block w-3 h-3 mt-1.5 mr-2 ${greenDotClass} rounded-full flex-shrink-0" aria-hidden="true"></span>
                                            "Alagamentos frequentes na Avenida Principal em Vila dos Cabanos durante o período chuvoso"
                                        </li>
                                        <li class="flex items-start">
                                            <span class="inline-block w-3 h-3 mt-1.5 mr-2 ${greenDotClass} rounded-full flex-shrink-0" aria-hidden="true"></span>
                                            "Insuficiência de vagas em creches municipais no bairro Pioneiro"
                                        </li>
                                        <li class="flex items-start">
                                            <span class="inline-block w-3 h-3 mt-1.5 mr-2 ${greenDotClass} rounded-full flex-shrink-0" aria-hidden="true"></span>
                                            "Ocorrência crescente de dengue nos últimos dois anos em Barcarena Sede"
                                        </li>
                                    </ul>
                                </div>
                                
                                <div>
                                    <p class="font-medium ${redClass} mb-2 text-sm sm:text-base flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                                        </svg>
                                        O que NÃO são problemas (para esta fase):
                                    </p>
                                    <ul class="list-none pl-5 space-y-2 text-sm sm:text-base">
                                        <li class="flex items-start">
                                            <span class="inline-block w-3 h-3 mt-1.5 mr-2 ${redDotClass} rounded-full flex-shrink-0" aria-hidden="true"></span>
                                            <span>Sugestões de obras: "Construir uma UPA no bairro Pedreira"</span>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="inline-block w-3 h-3 mt-1.5 mr-2 ${redDotClass} rounded-full flex-shrink-0" aria-hidden="true"></span>
                                            <span>Demandas diretas: "Precisamos de mais ônibus para Vila dos Cabanos"</span>
                                        </li>
                                        <li class="flex items-start">
                                            <span class="inline-block w-3 h-3 mt-1.5 mr-2 ${redDotClass} rounded-full flex-shrink-0" aria-hidden="true"></span>
                                            <span>Críticas genéricas: "A prefeitura não trabalha direito"</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </section>
                        
                        <section class="mb-6 space-y-4" aria-labelledby="secao-como-formular">
                            <h3 id="secao-como-formular" class="text-base sm:text-lg font-semibold ${highlightClass} border-b ${borderClass} pb-2 mb-4 flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clip-rule="evenodd" />
                                </svg>
                                Como Formular seu Problema:
                            </h3>
                            
                            <div class="p-4 rounded-lg ${cardClass}">
                                <ol class="list-none space-y-3 text-sm sm:text-base">
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">1</span>
                                        <div>
                                            <strong>Seja específico:</strong> Indique onde ocorre e quem é afetado
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">2</span>
                                        <div>
                                            <strong>Foque nas consequências:</strong> Quais impactos negativos este problema causa?
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">3</span>
                                        <div>
                                            <strong>Pense coletivamente:</strong> Priorize questões que afetam muitas pessoas
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">4</span>
                                        <div>
                                            <strong>Evite já propor soluções:</strong> Nesta etapa queremos entender OS PROBLEMAS
                                        </div>
                                    </li>
                                </ol>
                            </div>
                        </section>
                        
                        <section class="mb-6 space-y-4" aria-labelledby="secao-caminho">
                            <h3 id="secao-caminho" class="text-base sm:text-lg font-semibold ${highlightClass} border-b ${borderClass} pb-2 mb-4 flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M6.672 1.911a1 1 0 10-1.932.518l.259.966a1 1 0 001.932-.518l-.26-.966zM2.429 4.74a1 1 0 10-.517 1.932l.966.259a1 1 0 00.517-1.932l-.966-.26zm8.814-.569a1 1 0 00-1.415-1.414l-.707.707a1 1 0 101.415 1.415l.707-.708zm-7.071 7.072l.707-.707A1 1 0 003.465 9.12l-.708.707a1 1 0 001.415 1.415zm3.2-5.171a1 1 0 00-1.3 1.3l4 10a1 1 0 001.823.075l1.38-2.759 3.018 3.02a1 1 0 001.414-1.415l-3.019-3.02 2.76-1.379a1 1 0 00-.076-1.822l-10-4z" clip-rule="evenodd" />
                                </svg>
                                O Caminho da Sua Contribuição:
                            </h3>
                            
                            <div class="rounded-xl overflow-hidden ${AppState.isDarkTheme ? 'bg-gray-700' : 'bg-white'} border ${AppState.isDarkTheme ? 'border-gray-600' : 'border-gray-200'} shadow-sm mb-4" role="img" aria-label="Fluxograma do processo de contribuição">
                                <div class="flex flex-col sm:flex-row items-center justify-between text-center">
                                    <div class="${AppState.isDarkTheme ? 'bg-green-700' : 'bg-green-600'} text-white p-3 w-full sm:w-1/5 relative overflow-hidden group">
                                        <div class="font-bold mb-1 flex justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
                                            </svg>
                                            PROBLEMA
                                        </div>
                                        <div class="text-xs">Sua contribuição</div>
                                    </div>
                                    
                                    <div class="hidden sm:flex items-center justify-center text-green-600 w-8" aria-hidden="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                                        </svg>
                                    </div>
                                    
                                    <div class="${AppState.isDarkTheme ? 'bg-green-600' : 'bg-green-500'} text-white p-3 w-full sm:w-1/5 relative overflow-hidden group">
                                        <div class="font-bold mb-1 flex justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                                            </svg>
                                            ANÁLISE
                                        </div>
                                        <div class="text-xs">Agrupamento técnico</div>
                                    </div>
                                    
                                    <div class="hidden sm:flex items-center justify-center text-green-600 w-8" aria-hidden="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                                        </svg>
                                    </div>
                                    
                                    <div class="${AppState.isDarkTheme ? 'bg-green-600' : 'bg-green-500'} text-white p-3 w-full sm:w-1/5 relative overflow-hidden group">
                                        <div class="font-bold mb-1 flex justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3" />
                                            </svg>
                                            PRIORIZAÇÃO
                                        </div>
                                        <div class="text-xs">Definição de desafios</div>
                                    </div>
                                    
                                    <div class="hidden sm:flex items-center justify-center text-green-600 w-8" aria-hidden="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                                        </svg>
                                    </div>
                                    
                                    <div class="${AppState.isDarkTheme ? 'bg-green-600' : 'bg-green-500'} text-white p-3 w-full sm:w-1/5 relative overflow-hidden group">
                                        <div class="font-bold mb-1 flex justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                            </svg>
                                            PLANEJAMENTO
                                        </div>
                                        <div class="text-xs">Criação de programas</div>
                                    </div>
                                    
                                    <div class="hidden sm:flex items-center justify-center text-green-600 w-8" aria-hidden="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                                        </svg>
                                    </div>
                                    
                                    <div class="${AppState.isDarkTheme ? 'bg-green-500' : 'bg-green-400'} text-white p-3 w-full sm:w-1/5 relative overflow-hidden group">
                                        <div class="font-bold mb-1 flex justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                            </svg>
                                            AÇÃO
                                        </div>
                                        <div class="text-xs">Implementação</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="p-4 rounded-lg ${cardClass}">
                                <p class="mb-2 text-sm sm:text-base">Após esta fase de consulta, sua contribuição será:</p>
                                <ol class="list-none space-y-2 text-sm sm:text-base">
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">1</span>
                                        <div>
                                            <strong>Analisada</strong> e agrupada com problemas similares
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">2</span>
                                        <div>
                                            <strong>Transformada</strong> em problemáticas estruturadas
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">3</span>
                                        <div>
                                            <strong>Sistematizada</strong> para definir os macrodesafios do município
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">4</span>
                                        <div>
                                            <strong>Convertida</strong> em programas de governo com objetivos claros
                                        </div>
                                    </li>
                                    <li class="flex items-start">
                                        <span class="inline-flex items-center justify-center w-6 h-6 mr-3 rounded-full bg-green-600 text-white font-bold flex-shrink-0" aria-hidden="true">5</span>
                                        <div>
                                            <strong>Implementada</strong> através de iniciativas concretas com metas
                                        </div>
                                    </li>
                                </ol>
                            </div>
                        </section>
                        
                        <section class="mb-6 space-y-4" aria-labelledby="secao-participacao">
                            <h3 id="secao-participacao" class="text-base sm:text-lg font-semibold ${highlightClass} border-b ${borderClass} pb-2 mb-4 flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                                Por Que Sua Participação é Fundamental:
                            </h3>
                            
                            <div class="p-4 rounded-lg ${cardClass}">
                                <p class="mb-4 text-sm sm:text-base">Ninguém conhece melhor os desafios do seu bairro e da sua cidade do que você. Sua contribuição garante um planejamento:</p>
                                <ul class="list-none space-y-2 text-sm sm:text-base">
                                    <li class="flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 ${highlightClass}" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                                        </svg>
                                        <strong>Democrático:</strong> construído a partir das necessidades reais
                                    </li>
                                    <li class="flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 ${highlightClass}" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                                        </svg>
                                        <strong>Efetivo:</strong> focado em resolver problemas prioritários
                                    </li>
                                    <li class="flex items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 ${highlightClass}" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                                        </svg>
                                        <strong>Transparente:</strong> com processo claro do início ao fim
                                    </li>
                                </ul>
                            </div>
                        </section>
                        
                        <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mt-6 sm:mt-8">
                            <button onclick="openFAQ()" class="${AppState.isDarkTheme ? 'bg-gray-700 hover:bg-gray-600 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-800'} font-medium py-2 px-4 rounded-lg text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-gray-400 transition-all duration-200 flex items-center justify-center w-full sm:w-auto mb-3 sm:mb-0" aria-label="Saiba mais sobre o processo de participação">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                                </svg>
                                CLIQUE AQUI PARA SABER MAIS SOBRE O PROCESSO
                            </button>
                        </div>
                        
                        <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mt-4">
                            <button onclick="startContribution()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transform transition hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center w-full sm:w-auto" aria-label="Clique aqui e indique um problema">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z" clip-rule="evenodd" />
                                </svg>
                                CLIQUE AQUI E INDIQUE UM PROBLEMA
                            </button>
                        </div>
                    </main>
                </div>
            `;
        }

        function renderTelaFAQ() {
            const containerClass = AppState.isDarkTheme ? 'bg-gray-800 text-gray-100' : 'bg-white text-gray-800';
            const headerClass = AppState.isDarkTheme ? 'bg-green-700' : 'bg-green-600';
            const cardClass = AppState.isDarkTheme ? 'bg-gray-700/50' : 'bg-gray-50';
            const questionClass = AppState.isDarkTheme ? 'bg-gray-700 hover:bg-gray-600' : 'bg-gray-100 hover:bg-gray-200';
            const answerClass = AppState.isDarkTheme ? 'bg-gray-800/50' : 'bg-white';
            const borderClass = AppState.isDarkTheme ? 'border-gray-600' : 'border-gray-200';
            const highlightClass = AppState.isDarkTheme ? 'text-green-400' : 'text-green-600';
            
            const faqData = [
                {
                    section: "Sobre o PPA",
                    questions: [
                        {
                            id: "ppa-o-que-e",
                            question: "O que é o Plano Plurianual (PPA)?",
                            answer: "O PPA é o principal instrumento de planejamento governamental que estabelece as diretrizes, objetivos e metas da administração pública municipal para os próximos quatro anos (2026-2029). Ele organiza os programas e ações do governo, define prioridades de investimentos públicos, estabelece indicadores para acompanhar os resultados, orienta a elaboração dos orçamentos anuais e promove a transparência na gestão pública."
                        },
                        {
                            id: "ppa-periodo",
                            question: "Qual é o período coberto pelo PPA 2026-2029?",
                            answer: "O PPA abrange o quadriênio de 2026 a 2029."
                        },
                        {
                            id: "ppa-importancia",
                            question: "Por que o PPA é importante?",
                            answer: "O PPA é essencial porque reflete as necessidades da população, organiza as ações do governo, prioriza investimentos e garante que os recursos sejam utilizados de forma transparente e alinhada aos objetivos coletivos."
                        }
                    ]
                },
                {
                    section: "Sobre a Consulta Popular",
                    questions: [
                        {
                            id: "consulta-o-que-e",
                            question: "O que é a Consulta Popular?",
                            answer: "A Consulta Popular é uma etapa pública de participação no processo de construção do PPA 2026-2029, na qual a população de Barcarena pode contribuir identificando problemas públicos e sugerindo soluções."
                        },
                        {
                            id: "consulta-quando",
                            question: "Quando ocorre a Consulta Pública Digital?",
                            answer: "A Consulta Pública Digital acontece entre 01 de junho e 15 de junho de 2025."
                        },
                        {
                            id: "consulta-como-participar",
                            question: "Como posso participar da Consulta Pública Digital?",
                            answer: "Você pode participar acessando a plataforma digital disponível no site da Prefeitura: participa.barcarena.pa.gov.br."
                        },
                        {
                            id: "consulta-o-que-informar",
                            question: "O que devo informar na Consulta Pública?",
                            answer: "É necessário fornecer:\n→ A identificação do problema público (situação indesejável que afeta a coletividade)\n→ A localização do problema (bairro, comunidade ou região afetada)\n→ Uma descrição clara e objetiva de como o problema é percebido"
                        },
                        {
                            id: "problema-publico-definicao",
                            question: "O que é considerado um problema público?",
                            answer: "Um problema público é uma situação indesejável que:\n→ Afeta um número significativo de pessoas\n→ Gera impacto social negativo na comunidade\n→ Requer intervenção governamental para sua solução\n→ Está dentro das competências do município"
                        },
                        {
                            id: "quem-pode-participar",
                            question: "Quem pode participar da Consulta Popular?",
                            answer: "A consulta é aberta a todos os cidadãos residentes no município, individualmente ou organizados por meio de associações de moradores, entidades representativas, organizações da sociedade civil, conselhos municipais, empresas e instituições locais."
                        },
                        {
                            id: "por-que-participar",
                            question: "Por que devo participar da Consulta Popular?",
                            answer: "Participar permite que você:\n→ Exercite seu direito à cidadania\n→ Contribua para um planejamento mais eficiente\n→ Ajude a identificar problemas prioritários da sua comunidade\n→ Influencie diretamente as decisões que moldarão o futuro da cidade"
                        }
                    ]
                },
                {
                    section: "Sobre o Processamento das Contribuições",
                    questions: [
                        {
                            id: "processamento-contribuicoes",
                            question: "O que acontece com as contribuições após a Consulta Pública?",
                            answer: "Entre 16 de junho e 06 de julho de 2025, as equipes técnicas da Prefeitura irão:\n→ Analisar todas as contribuições recebidas\n→ Consolidar demandas semelhantes\n→ Definir os macrodesafios do plano\n→ Estabelecer objetivos setoriais\n→ Avaliar a viabilidade técnica e orçamentária das iniciativas\n→ Construir a estrutura programática do plano, incluindo custos e metas anuais"
                        }
                    ]
                },
                {
                    section: "Sobre a Audiência Pública",
                    questions: [
                        {
                            id: "audiencia-o-que-e",
                            question: "O que é a Audiência Pública?",
                            answer: "A Audiência Pública é um evento em que a população poderá conhecer como suas contribuições foram incorporadas ao PPA e ajudar a construir a agenda de desenvolvimento participativo."
                        },
                        {
                            id: "audiencia-quando-onde",
                            question: "Quando e onde ocorrerá a Audiência Pública?",
                            answer: "→ Data: 10 de julho de 2025\n→ Horário: 19h\n→ Local: Auditório da Escola Municipal de Ensino Infantil e Fundamental Checralla Salim Khayat (com transmissão ao vivo pelas redes sociais da Prefeitura)"
                        },
                        {
                            id: "audiencia-objetivo",
                            question: "Qual é o objetivo da Audiência Pública?",
                            answer: "O objetivo é apresentar à população como as contribuições foram incluídas no plano e definir, em conjunto, a agenda de desenvolvimento participativo."
                        }
                    ]
                },
                {
                    section: "Informações Gerais e Dúvidas",
                    questions: [
                        {
                            id: "mais-informacoes",
                            question: "Onde posso encontrar mais informações sobre o processo?",
                            answer: "Informações detalhadas serão publicadas em diversos meios de comunicação da Prefeitura. Fique atento aos canais oficiais."
                        },
                        {
                            id: "tirar-duvidas",
                            question: "Como posso tirar dúvidas ou obter mais esclarecimentos?",
                            answer: "Você pode enviar suas dúvidas ou solicitações de informações para a Secretaria de Planejamento pelo e-mail: participa@barcarena.pa.gov.br."
                        }
                    ]
                }
            ];
            
            let sectionsHTML = '';
            
            faqData.forEach(section => {
                let questionsHTML = '';
                
                section.questions.forEach(item => {
                    const isOpen = AppState.openFAQItems.has(item.id);
                    questionsHTML += `
                        <div class="border ${borderClass} rounded-lg mb-3 overflow-hidden">
                            <button 
                                onclick="toggleFAQItem('${item.id}')"
                                class="${questionClass} w-full text-left p-4 font-medium transition-colors duration-200 flex justify-between items-center focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40"
                                aria-expanded="${isOpen}"
                                aria-controls="answer-${item.id}"
                            >
                                <span class="text-sm sm:text-base">${item.question}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-200 ${isOpen ? 'rotate-180' : ''}" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                            <div 
                                id="answer-${item.id}"
                                class="${answerClass} transition-all duration-300 ${isOpen ? 'max-h-screen border-t ' + borderClass : 'max-h-0'} overflow-hidden"
                                aria-hidden="${!isOpen}"
                            >
                                <div class="p-4 text-sm sm:text-base leading-relaxed" style="white-space: pre-line;">
                                    ${item.answer}
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                sectionsHTML += `
                    <section class="mb-8" aria-labelledby="secao-${section.section.toLowerCase().replace(/\s+/g, '-')}">
                        <h3 id="secao-${section.section.toLowerCase().replace(/\s+/g, '-')}" class="text-lg sm:text-xl font-semibold ${highlightClass} mb-4 border-b ${AppState.isDarkTheme ? 'border-green-800' : 'border-green-100'} pb-2">
                            ${section.section}
                        </h3>
                        <div class="space-y-3">
                            ${questionsHTML}
                        </div>
                    </section>
                `;
            });
            
            return `
                <div class="${containerClass} p-4 sm:p-6 rounded-xl shadow-lg max-w-4xl mx-auto transition-all duration-300 transform ${AppState.fadeIn ? 'opacity-100 scale-100' : 'opacity-0 scale-95'}" role="region" aria-labelledby="titulo-faq">
                    <a href="#conteudo-faq" class="screen-reader-only">Pular para o conteúdo principal</a>
                    
                    <div class="${headerClass} text-white p-3 sm:p-4 rounded-t-xl -mt-4 -mx-4 sm:-mt-6 sm:-mx-6 mb-6 relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-r from-green-600 to-green-500 opacity-50"></div>
                        <div class="relative z-10">
                            <h1 id="titulo-faq" class="text-xl sm:text-2xl font-bold text-center">
                                Principais Dúvidas sobre o Processo de Participação Popular
                            </h1>
                        </div>
                    </div>

                    <main id="conteudo-faq" tabindex="-1">
                        <div class="mb-6 p-4 rounded-lg ${cardClass}">
                            <p class="text-center text-sm sm:text-base">
                                Clique nas perguntas abaixo para ver as respostas detalhadas sobre o processo de participação no Plano Plurianual 2026-2029.
                            </p>
                        </div>
                        
                        ${sectionsHTML}
                        
                        <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mt-8 pt-6 border-t ${borderClass}">
                            <button onclick="goBack()" class="${AppState.isDarkTheme ? 'bg-gray-700 hover:bg-gray-600 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-800'} font-medium py-2 px-4 rounded-lg text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-gray-400 transition-all duration-200 flex items-center justify-center w-full sm:w-auto" aria-label="Voltar para a tela inicial">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                                </svg>
                                Voltar ao Início
                            </button>
                            
                            <button onclick="startContribution()" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transform transition hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center w-full sm:w-auto" aria-label="Indicar um problema público">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z" clip-rule="evenodd" />
                                </svg>
                                Indicar um Problema
                            </button>
                        </div>
                    </main>
                </div>
            `;
        }

        function renderTelaFormulario() {
            const containerClass = AppState.isDarkTheme ? 'bg-gray-800 text-gray-100' : 'bg-white text-gray-800';
            const headerClass = AppState.isDarkTheme ? 'bg-green-700' : 'bg-green-600';
            const inputClass = AppState.isDarkTheme ? 'bg-gray-700 border-gray-600 focus:border-green-500' : 'bg-white border-gray-300 focus:border-green-500';
            const selectClass = AppState.isDarkTheme ? 'bg-gray-700 border-gray-600 text-gray-100' : 'bg-white border-gray-300';
            const progressClass = AppState.isDarkTheme ? 'bg-gray-700' : 'bg-gray-200';
            const progressFillClass = AppState.isDarkTheme ? 'bg-green-500' : 'bg-green-600';
            
            return `
                <div class="${containerClass} p-4 sm:p-6 rounded-xl shadow-lg max-w-md mx-auto transition-all duration-300 transform ${AppState.fadeIn ? 'opacity-100 scale-100' : 'opacity-0 scale-95'}" role="region" aria-labelledby="titulo-problema">
                    <a href="#form-problema" class="screen-reader-only">Pular para o conteúdo principal</a>
                    
                    <div class="${headerClass} text-white p-3 rounded-t-xl -mt-4 -mx-4 sm:-mt-6 sm:-mx-6 mb-6 relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-r from-green-600 to-green-500 opacity-50"></div>
                        <div class="relative z-10">
                            <h1 id="titulo-problema" class="text-lg sm:text-xl font-bold text-center">Indique um Problema Público</h1>
                        </div>
                    </div>
                    
                    <div class="mb-6 px-2">
                        <div class="flex justify-between mb-1">
                            <span class="text-xs font-semibold inline-block">Passo 1 de 2</span>
                            <span class="text-xs font-semibold inline-block">50%</span>
                        </div>
                        <div class="overflow-hidden h-2 text-xs flex rounded ${progressClass}">
                            <div style="width: 50%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center ${progressFillClass} transition-all duration-500"></div>
                        </div>
                    </div>
                    
                    <main id="form-problema" tabindex="-1">
                        <div class="space-y-5">
                            <div class="space-y-2">
                                <label for="problema" class="block text-sm font-medium mb-1">
                                    Descreva o problema público<span class="text-red-500">*</span>
                                </label>
                                ${AppState.isIOS ? `
                                    <textarea id="problema" class="w-full p-3 border ${inputClass} rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" rows="3" placeholder="Ex: Alagamentos frequentes na Avenida Principal durante o período chuvoso" maxlength="150" aria-required="true" aria-describedby="problema-contador" autocomplete="off"></textarea>
                                ` : `
                                    <textarea id="problema" value="${AppState.problema}" onchange="AppState.problema = this.value" oninput="AppState.problema = this.value" class="w-full p-3 border ${inputClass} rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" rows="3" placeholder="Ex: Alagamentos frequentes na Avenida Principal durante o período chuvoso" maxlength="150" aria-required="true" aria-describedby="problema-contador" autocomplete="off">${AppState.problema}</textarea>
                                `}
                                <div class="flex justify-between text-xs sm:text-sm" id="problema-contador">
                                    <span class="${AppState.problema.length > 130 ? AppState.isDarkTheme ? "text-amber-400" : "text-orange-500" : AppState.isDarkTheme ? "text-gray-400" : "text-gray-500"}">
                                        ${AppState.problema.length}/150 caracteres
                                    </span>
                                    ${AppState.problema.length > 140 ? `<span class="${AppState.isDarkTheme ? "text-amber-400" : "text-orange-500"}">Limite próximo!</span>` : ''}
                                </div>
                            </div>
                            
                            <div class="space-y-2">
                                <label for="regiao" class="block text-sm font-medium mb-1">
                                    Região onde o problema ocorre<span class="text-red-500">*</span>
                                </label>
                                <select id="regiao" value="${AppState.regiao}" onchange="AppState.regiao = this.value" class="w-full p-3 ${selectClass} border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" aria-required="true">
                                    <option value="" disabled>Selecione uma região</option>
                                    <option value="Barcarena Sede">Barcarena Sede</option>
                                    <option value="Região do Murucupí">Região do Murucupí</option>
                                    <option value="Região da Vila do Conde">Região da Vila do Conde</option>
                                    <option value="Região das Estradas">Região das Estradas</option>
                                    <option value="Região das Ilhas">Região das Ilhas</option>
                                    <option value="Em todo o território municipal">Em todo o território municipal</option>
                                </select>
                            </div>
                            
                            <div class="space-y-2">
                                <label for="bairro" class="block text-sm font-medium mb-1">
                                    Bairro ou localidade<span class="text-red-500">*</span>
                                </label>
                                ${AppState.isIOS ? `
                                    <input type="text" id="bairro" class="w-full p-3 ${inputClass} border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" placeholder="Ex: Vila dos Cabanos, Pedreira" maxlength="25" aria-required="true" aria-describedby="bairro-contador" autocomplete="address-level3" />
                                ` : `
                                    <input type="text" id="bairro" value="${AppState.bairro}" onchange="AppState.bairro = this.value" oninput="AppState.bairro = this.value" class="w-full p-3 ${inputClass} border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" placeholder="Ex: Vila dos Cabanos, Pedreira" maxlength="25" aria-required="true" aria-describedby="bairro-contador" autocomplete="address-level3" />
                                `}
                                <div class="flex justify-between text-xs sm:text-sm" id="bairro-contador">
                                    <span class="${AppState.bairro.length > 20 ? AppState.isDarkTheme ? "text-amber-400" : "text-orange-500" : AppState.isDarkTheme ? "text-gray-400" : "text-gray-500"}">
                                        ${AppState.bairro.length}/25 caracteres
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        ${renderErrorMessage(AppState.error)}
                        
                        <div class="flex flex-wrap justify-end items-center mt-6 gap-2">
                            <button type="button" onclick="goBack()" class="${AppState.isDarkTheme ? 'bg-gray-700 hover:bg-gray-600 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-800'} font-medium py-2 px-4 rounded-lg text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-gray-400 transition-all duration-200" aria-label="Voltar para a tela inicial">
                                <span class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                                    </svg>
                                    Voltar
                                </span>
                            </button>
                            
                            <button type="button" onclick="validateAndAdvance()" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-5 rounded-lg text-sm sm:text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-60 transition-all duration-200" aria-label="Avançar para a próxima etapa">
                                <span class="flex items-center">
                                    Avançar
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd" />
                                    </svg>
                                </span>
                            </button>
                        </div>
                    </main>
                </div>
            `;
        }

        function renderTelaPessoal() {
            const containerClass = AppState.isDarkTheme ? 'bg-gray-800 text-gray-100' : 'bg-white text-gray-800';
            const headerClass = AppState.isDarkTheme ? 'bg-green-700' : 'bg-green-600';
            const inputClass = AppState.isDarkTheme ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300';
            const selectClass = AppState.isDarkTheme ? 'bg-gray-700 border-gray-600 text-gray-100' : 'bg-white border-gray-300';
            const progressClass = AppState.isDarkTheme ? 'bg-gray-700' : 'bg-gray-200';
            const progressFillClass = AppState.isDarkTheme ? 'bg-green-500' : 'bg-green-600';
            const linkClass = AppState.isDarkTheme ? 'text-green-400 hover:text-green-300' : 'text-green-600 hover:text-green-800';
            
            return `
                <div class="${containerClass} p-4 sm:p-6 rounded-xl shadow-lg max-w-md mx-auto transition-all duration-300 transform ${AppState.fadeIn ? 'opacity-100 scale-100' : 'opacity-0 scale-95'}" role="region" aria-labelledby="titulo-pessoal">
                    <a href="#form-pessoal" class="screen-reader-only">Pular para o conteúdo principal</a>
                    
                    <div class="${headerClass} text-white p-3 rounded-t-xl -mt-4 -mx-4 sm:-mt-6 sm:-mx-6 mb-6 relative overflow-hidden">
                        <div class="absolute inset-0 bg-gradient-to-r from-green-600 to-green-500 opacity-50"></div>
                        <div class="relative z-10">
                            <h1 id="titulo-pessoal" class="text-lg sm:text-xl font-bold text-center">Fale um pouco sobre você</h1>
                        </div>
                    </div>
                    
                    <div class="mb-6 px-2">
                        <div class="flex justify-between mb-1">
                            <span class="text-xs font-semibold inline-block">Passo 2 de 2</span>
                            <span class="text-xs font-semibold inline-block">100%</span>
                        </div>
                        <div class="overflow-hidden h-2 text-xs flex rounded ${progressClass}">
                            <div style="width: 100%" class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center ${progressFillClass} transition-all duration-500"></div>
                        </div>
                    </div>
                    
                    <main id="form-pessoal" tabindex="-1">
                        <div class="space-y-5">
                            <div class="space-y-2">
                                <label for="genero" class="block text-sm font-medium mb-1">
                                    Com qual gênero você se identifica<span class="text-red-500">*</span>
                                </label>
                                <select id="genero" value="${AppState.genero}" onchange="AppState.genero = this.value" class="w-full p-3 ${selectClass} border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" aria-required="true">
                                    <option value="" disabled>Selecione uma opção</option>
                                    <option value="Feminino">Feminino</option>
                                    <option value="Masculino">Masculino</option>
                                    <option value="Não-binário">Não-binário</option>
                                    <option value="Prefiro não informar">Prefiro não informar</option>
                                    <option value="Outro">Outro</option>
                                </select>
                            </div>
                            
                            <div class="space-y-2">
                                <label for="ocupacao" class="block text-sm font-medium mb-1">
                                    Qual a sua ocupação<span class="text-red-500">*</span>
                                </label>
                                <select id="ocupacao" value="${AppState.ocupacao}" onchange="AppState.ocupacao = this.value" class="w-full p-3 ${selectClass} border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" aria-required="true">
                                    <option value="" disabled>Selecione uma opção</option>
                                    <option value="Estudante">Estudante</option>
                                    <option value="Servidor Público">Servidor Público</option>
                                    <option value="Empregado do Setor Privado">Empregado do Setor Privado</option>
                                    <option value="Empreendedor">Empreendedor/Empresário</option>
                                    <option value="Autônomo">Autônomo/Profissional Liberal</option>
                                    <option value="Aposentado">Aposentado/Pensionista</option>
                                    <option value="Trabalho Informal">Trabalho Informal</option>
                                    <option value="Desempregado">Desempregado</option>
                                    <option value="Produtor Rural">Produtor Rural</option>
                                    <option value="Pescador">Pescador</option>
                                    <option value="Outro">Outro</option>
                                </select>
                            </div>
                            
                            <div class="space-y-2">
                                <label for="cep" class="block text-sm font-medium mb-1">
                                    CEP da sua residência<span class="text-red-500">*</span>
                                </label>
                                ${AppState.isIOS ? `
                                    <input type="text" inputmode="numeric" id="cep" class="w-full p-3 ${inputClass} border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" placeholder="00000-000" maxlength="9" aria-required="true" autocomplete="postal-code" />
                                ` : `
                                    <input type="text" inputmode="numeric" id="cep" value="${AppState.cep}" onchange="AppState.cep = formatCEP(this.value)" oninput="AppState.cep = formatCEP(this.value)" class="w-full p-3 ${inputClass} border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" placeholder="00000-000" maxlength="9" aria-required="true" autocomplete="postal-code" />
                                `}
                                <div class="mt-1">
                                    <a href="https://buscacepinter.correios.com.br/app/localidade_logradouro/index.php" target="_blank" rel="noopener noreferrer" class="${linkClass} hover:underline text-xs sm:text-sm flex items-center" aria-label="Buscar CEP no site dos Correios (abre em nova janela)">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" />
                                        </svg>
                                        Buscar CEP no site dos Correios
                                    </a>
                                </div>
                            </div>
                        </div>
                        
                        ${renderErrorMessage(AppState.error)}
                        
                        <div class="flex flex-wrap justify-between items-center mt-6 gap-2">
                            <button type="button" onclick="goBack()" class="${AppState.isDarkTheme ? 'bg-gray-700 hover:bg-gray-600 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-800'} font-medium py-2 px-4 rounded-lg text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-gray-400 transition-all duration-200" aria-label="Voltar para a etapa anterior">
                                <span class="flex items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                        <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                                    </svg>
                                    Voltar
                                </span>
                            </button>
                            
                            <button type="button" onclick="validateAndSubmit()" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-5 rounded-lg text-sm sm:text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-60 transition-all duration-200" aria-label="Enviar contribuição" ${AppState.isSubmitting ? 'disabled' : ''}>
                                <span class="flex items-center">
                                    ${AppState.isSubmitting ? `
                                        <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        Enviando...
                                    ` : `
                                        Enviar Contribuição
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-1" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z" clip-rule="evenodd" />
                                        </svg>
                                    `}
                                </span>
                            </button>
                        </div>
                    </main>
                </div>
            `;
        }

        function renderTelaConfirmacao() {
            const containerClass = AppState.isDarkTheme ? 'bg-gray-800 text-gray-100' : 'bg-white text-gray-800';
            const successClass = AppState.isDarkTheme ? 'bg-green-800/30 text-green-300' : 'bg-green-50 text-green-700';
            const cardClass = AppState.isDarkTheme ? 'bg-gray-700' : 'bg-gray-50';
            const borderClass = AppState.isDarkTheme ? 'border-gray-600' : 'border-gray-200';
            const inputClass = AppState.isDarkTheme ? 'bg-gray-700 border-gray-600' : 'bg-white border-gray-300';
            const labelClass = AppState.isDarkTheme ? 'text-gray-200' : 'text-gray-700';
            const helpClass = AppState.isDarkTheme ? 'text-gray-400' : 'text-gray-500';
            
            return `
                <div class="${containerClass} p-4 sm:p-6 rounded-lg shadow-md max-w-md mx-auto transition-opacity duration-300 ${AppState.fadeIn ? 'opacity-100' : 'opacity-0'}" role="region" aria-labelledby="titulo-confirmacao">
                    <div class="text-center py-4 sm:py-6">
                        <div class="${successClass} p-3 sm:p-4 rounded-lg mb-5">
                            <svg class="w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <h2 id="titulo-confirmacao" class="text-lg sm:text-xl font-bold mb-2">Contribuição Enviada com Sucesso!</h2>
                            <p class="text-sm sm:text-base">Obrigado por contribuir para o Plano Plurianual de Barcarena.</p>
                        </div>
                        
                        <p class="mb-6 text-sm sm:text-base">Sua contribuição será analisada pela equipe técnica da Secretaria Municipal de Planejamento e incorporada ao processo de planejamento municipal.</p>
                        
                        <div class="mt-5 ${cardClass} p-3 sm:p-4 rounded-lg border ${borderClass}">
                            <p class="text-left mb-4 text-sm sm:text-base">
                                Se você quiser conhecer mais sobre os órgãos, projetos e serviços da prefeitura, informe seu contato do WhatsApp e fale com a Bárbara, a atendente virtual da Prefeitura de Barcarena.
                            </p>
                            
                            <div class="mb-4">
                                <label for="whatsapp" class="block ${labelClass} font-medium mb-2 text-left text-sm sm:text-base">
                                    Seu número de WhatsApp com DDD:
                                </label>
                                ${AppState.isIOS ? `
                                    <input type="text" inputmode="tel" id="whatsapp" class="w-full p-2 sm:p-3 border ${inputClass} rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" placeholder="(00) 00000-0000" maxlength="16" aria-describedby="whatsapp-info" />
                                ` : `
                                    <input type="text" inputmode="tel" id="whatsapp" value="${AppState.whatsapp}" onchange="AppState.whatsapp = formatPhone(this.value)" oninput="AppState.whatsapp = formatPhone(this.value)" class="w-full p-2 sm:p-3 border ${inputClass} rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-40 text-sm sm:text-base" placeholder="(00) 00000-0000" maxlength="16" aria-describedby="whatsapp-info" />
                                `}
                                <div class="text-xs sm:text-sm ${helpClass} mt-1 text-left" id="whatsapp-info">
                                    Digite um número válido com DDD, como (91) 98765-4321
                                </div>
                            </div>
                            
                            ${renderErrorMessage(AppState.error)}
                            
                            <button onclick="validateAndSubmitWhatsApp()" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-5 rounded-lg text-sm sm:text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-60 transition-all duration-200" aria-label="Conversar pelo WhatsApp" ${AppState.isSubmitting ? 'disabled' : ''}>
                                ${AppState.isSubmitting ? `
                                    <span class="flex items-center">
                                        <svg class="animate-spin -ml-1 mr-2 h-4 w-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                        Registrando...
                                    </span>
                                ` : 'Conversar'}
                            </button>
                        </div>
                        
                        <div class="mt-6">
                            <button onclick="goBack()" class="${AppState.isDarkTheme ? 'bg-gray-700 hover:bg-gray-600 text-gray-200' : 'bg-gray-200 hover:bg-gray-300 text-gray-800'} font-medium py-2 px-4 rounded-lg text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-gray-400 transition-all duration-200" aria-label="Voltar para a tela inicial">
                                Voltar ao Início
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderTelaWhatsappConfirmacao() {
            const containerClass = AppState.isDarkTheme ? 'bg-gray-800 text-gray-100' : 'bg-white text-gray-800';
            const successClass = AppState.isDarkTheme ? 'bg-green-800/30 text-green-300' : 'bg-green-50 text-green-700';
            
            return `
                <div class="${containerClass} p-4 sm:p-6 rounded-lg shadow-md max-w-md mx-auto transition-opacity duration-300 ${AppState.fadeIn ? 'opacity-100' : 'opacity-0'}" role="region" aria-labelledby="titulo-whatsapp">
                    <div class="text-center py-6 sm:py-8">
                        <div class="${successClass} p-4 sm:p-6 rounded-lg mb-6">
                            <svg class="w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-4 sm:mb-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                            </svg>
                            <h2 id="titulo-whatsapp" class="text-xl sm:text-2xl font-bold mb-3">Obrigado pelo interesse!</h2>
                            <p class="text-base sm:text-lg">Observe seu WhatsApp, em breve entraremos em contato.</p>
                        </div>
                        
                        <div class="mt-6">
                            <button onclick="backToHome()" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-lg text-sm sm:text-base shadow-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-60 transition-all duration-200" aria-label="Voltar para a tela inicial">
                                Voltar ao Início
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Main rendering function
        function renderCurrentScreen() {
            const mainContent = document.getElementById('main-content');
            let content = '';
            
            switch(AppState.currentScreen) {
                case 'inicial':
                    content = renderTelaInicial();
                    AppState.focusRef = null;
                    break;
                case 'faq':
                    content = renderTelaFAQ();
                    break;
                case 'formulario':
                    content = renderTelaFormulario();
                    break;
                case 'pessoal':
                    content = renderTelaPessoal();
                    break;
                case 'confirmacao':
                    content = renderTelaConfirmacao();
                    break;
                case 'whatsapp-confirmacao':
                    content = renderTelaWhatsappConfirmacao();
                    break;
                default:
                    content = renderTelaInicial();
            }
            
            mainContent.innerHTML = content;
            
            // Apply animations
            if (AppState.fadeIn) {
                mainContent.style.opacity = '1';
                mainContent.style.transform = 'translateX(0)';
            }
            
            // Setup refs for iOS after rendering
            if (AppState.isIOS) {
                AppState.problemaRef = document.getElementById('problema');
                AppState.bairroRef = document.getElementById('bairro');
                AppState.cepRef = document.getElementById('cep');
                AppState.whatsappRef = document.getElementById('whatsapp');
                
                // Sync values from state to refs
                if (AppState.currentScreen === 'formulario') {
                    if (AppState.problemaRef) AppState.problemaRef.value = AppState.problema;
                    if (AppState.bairroRef) AppState.bairroRef.value = AppState.bairro;
                } else if (AppState.currentScreen === 'pessoal') {
                    if (AppState.cepRef) AppState.cepRef.value = AppState.cep;
                } else if (AppState.currentScreen === 'confirmacao') {
                    if (AppState.whatsappRef) AppState.whatsappRef.value = AppState.whatsapp;
                }
                
                setupIOSListeners();
            }
            
            // Set up select values
            const regiaoSelect = document.getElementById('regiao');
            if (regiaoSelect) regiaoSelect.value = AppState.regiao;
            
            const generoSelect = document.getElementById('genero');
            if (generoSelect) generoSelect.value = AppState.genero;
            
            const ocupacaoSelect = document.getElementById('ocupacao');
            if (ocupacaoSelect) ocupacaoSelect.value = AppState.ocupacao;
            
            // Set focus ref
            const mainElement = document.querySelector('main[tabindex="-1"]');
            if (mainElement) {
                AppState.focusRef = mainElement;
            }
        }

        // Global functions for event handlers
        function startContribution() {
            changeScreen('formulario', 'direita');
        }

        function backToHome() {
            AppState.fadeIn = false;
            const mainContent = document.getElementById('main-content');
            mainContent.style.opacity = '0';
            setTimeout(() => {
                AppState.currentScreen = 'inicial';
                clearForm();
                renderCurrentScreen();
                AppState.fadeIn = true;
                setTimeout(() => {
                    mainContent.style.opacity = '1';
                }, 50);
            }, 300);
        }

        // Initialize app
        function initApp() {
            detectIOS();
            updateTheme();
            renderCurrentScreen();
            
            // Set up theme toggle
            document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
        }

        // Start the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>